<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INTELLIROOM Dashboard</title>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">

    <!-- FontAwesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background: #0f0f1f;
            margin: 0;
            padding: 30px 15px;
            color: #fff;
        }

        h1 {
            text-align: center;
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 40px;
            color: #00d4ff;
            text-shadow: 0 0 10px #00d4ff;
        }

        .dashboard-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            max-width: 1200px;
            margin: auto;
        }

        .card {
            background: #1c1c2c;
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 8px 20px rgba(0,0,0,0.6);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-6px);
            box-shadow: 0 12px 28px rgba(0,0,0,0.8);
        }

        .icon i {
            font-size: 45px;
            color: #00d4ff;
            margin-bottom: 12px;
        }

        .value {
            font-size: 38px;
            font-weight: 700;
            margin: 10px 0;
        }

        .status {
            color: #ff6b6b;
        }

        .toggleLabel {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 16px;
            cursor: pointer;
        }

        .toggleSwitch {
            width: 22px;
            height: 22px;
            accent-color: #00d4ff;
            cursor: pointer;
        }

        .btn-group {
            margin-top: 12px;
        }

        .btn {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.25s ease;
        }

        .btn-green { background: #00ff95; color: #0a0a0a; }
        .btn-green:hover { background: #00cc77; }
        .btn-red { background: #ff4d6d; color: #fff; }
        .btn-red:hover { background: #e63950; }

        .card h2 {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 8px;
        }
    </style>
</head>
<body>

<h1>IntelliRoom Dashboard</h1>

<div class="dashboard-container">

    <!-- Temperature Card -->
    <div class="card">
        <div class="icon"><i class="fas fa-temperature-high"></i></div>
        <h2>Temperature</h2>
        <p id="temp" class="value">-- °C</p>
    </div>

    <!-- Fan Status Card -->
    <div class="card">
        <div class="icon"><i class="fas fa-fan"></i></div>
        <h2>Fan Status</h2>
        <p id="fanStatus" class="value status">OFF</p>
    </div>

    <!-- Mode Control Card -->
    <div class="card">
        <div class="icon"><i class="fas fa-sliders-h"></i></div>
        <h2>Control Mode</h2>
        <label class="toggleLabel">
            <input type="checkbox" id="toggleMode" class="toggleSwitch">
            Manual Mode
        </label>
    </div>

    <!-- Manual Fan Control Card -->
    <div class="card">
        <div class="icon"><i class="fas fa-hand-pointer"></i></div>
        <h2>Manual Fan Control</h2>
        <div class="btn-group">
            <button id="fanOn" class="btn btn-green">Turn ON</button>
            <button id="fanOff" class="btn btn-red">Turn OFF</button>
        </div>
    </div>

</div>

<!-- Firebase & App JS -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js";
import { getDatabase, ref, onValue, set } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-database.js";

// Firebase config
const firebaseConfig = {
    apiKey: "AIzaSyAv_ZS8PLXoTcDIXkE-deVKgTPgIUchKJc",
    databaseURL: "https://intelliroom-50474-default-rtdb.asia-southeast1.firebasedatabase.app/",
    projectId: "intelliroom-50474"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// Database references
const tempRef = ref(db, "intelliroom/temperature");
const fanRef = ref(db, "intelliroom/fanStatus");
const manualModeRef = ref(db, "intelliroom/manualMode");
const manualFanStateRef = ref(db, "intelliroom/manualFanState");

// Real-time updates
onValue(tempRef, snapshot => {
    const temp = snapshot.val();
    if(temp !== null) document.getElementById("temp").innerText = temp.toFixed(1) + " °C";
});

onValue(fanRef, snapshot => {
    const status = snapshot.val();
    if(status !== null) document.getElementById("fanStatus").innerText = status;
});

onValue(manualModeRef, snapshot => {
    const mode = snapshot.val();
    if(mode !== null) document.getElementById("toggleMode").checked = mode;
});

// Toggle manual mode
document.getElementById("toggleMode").addEventListener("change", function() {
    set(manualModeRef, this.checked);
});

// Manual fan controls
document.getElementById("fanOn").addEventListener("click", () => set(manualFanStateRef, true));
document.getElementById("fanOff").addEventListener("click", () => set(manualFanStateRef, false));

</script>

</body>
</html>
